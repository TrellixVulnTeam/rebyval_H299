INFO:  parse config from command line.
[32mexperiment: [39m
[32m	context: [39m
		name: multi-p-test
		multi-p: True
		author: Enzhi Zhang & Ruqin Wang
		log_path: ./log
[32m	main_loop: [39m
[32m		warmup: [39m
			student_nums: 0
			supervisor_trains: 1
		nums: 1
		student_nums: 1
[32m	student: [39m
[32m		dataloader: [39m
			name: cifar10
			batch_size: 128
			epochs: 15
			path: ~/.keras/dataset/cifar10
[32m		model: [39m
			name: dnn
			units: [64, 32, 16, 10]
			activations: ['relu', 'relu', 'relu', 'softmax']
[32m		loss: [39m
			name: SparseCategoricalCrossentropy
			metrics: SparseCategoricalAccuracy
[32m		metrics: [39m
			name: SparseCategoricalAccuracy
[32m		optimizer: [39m
			name: sgd
			learning_rate: 0.1
[32m		train_loop: [39m
[32m			valid: [39m
[32m				weight_space: [39m
					format: sum_reduce
				valid_gap: 10
[32m				save_model: [39m
					save_in: student
					save_after_epoch: 1
[32m			train: [39m
				epochs: 10
[32m			test: [39m
				epoch: 10
[32m	supervisor: [39m
[32m		dataloader: [39m
			name: dnn_sumreduce
			replay_window: 1000
			batch_size: 128
			epochs: 100
			format: tensor
[32m		model: [39m
			name: dnn
			units: [64, 32, 16, 1]
			activations: ['relu', 'relu', 'relu', 'softplus']
			dims: 64,32,16,1
[32m		optimizer: [39m
			name: sgd
			learning_rate: 0.01
[32m		loss: [39m
			name: MeanAbsoluteError
[32m		train_loop: [39m
[32m			valid: [39m
				valid_gap: 100
[32m				save_model: [39m
					save_in: supvervisor
					save_after_epochs: 1
[32m			preprocess: [39m
				name: normal
[32m			train: [39m
				epochs: 10
[32m			test: [39m
				epoch: 10
[32m		metrics: [39m
			name: MeanSquaredError
[32mStart to run![39m
[32m[PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')][39m
[32mweight_space_path:./log/multi-p-test/weight_space[39m
filelist length: 20
[33mWARNING: no such path: ./log/multi-p-test/tensorboard/supervisor-20220525-135127, but we made.[39m
[32mdevices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')][39m
[33mWARNING: no such path: ./log/multi-p-test/tensorboard/student-20-20220525-135235, but we made.[39m
Finished training student 20
[32mnew_student:['./log/multi-p-test/weight_space/20.tfrecords'], welcome![39m
[32mweight_space_path:./log/multi-p-test/weight_space[39m
filelist length: 21
[32m[Task Status]: Task done! Time cost: {:}[39m
