INFO:  parse config from command line.
[32mexperiment: [39m
[32m	context: [39m
		name: cifar10-rl
		multi-p: True
		author: Enzhi Zhang & Ruqin Wang
		log_path: ./log
[32m	main_loop: [39m
[32m		warmup: [39m
			student_nums: 20
			supervisor_trains: 0
		nums: 0
		student_nums: 0
[32m	student: [39m
[32m		dataloader: [39m
			name: cifar10
			batch_size: 128
			epochs: 3
			da: False
			task: RL
			path: ~/.keras/dataset/cifar10
[32m		model: [39m
			name: dnn
			units: [128, 64, 32, 10]
			activations: ['relu', 'relu', 'relu', 'softmax']
[32m		loss: [39m
			name: CategoricalCrossentropy
			metrics: SparseCategoricalAccuracy
[32m		metrics: [39m
			name: categorical_accuracy
[32m		optimizer: [39m
			name: sgd
			learning_rate: 0.1
[32m		train_loop: [39m
[32m			train: [39m
				lr_decay: False
				epochs: 10
[32m			valid: [39m
[32m				weight_space: [39m
					format: sum_reduce
				valid_gap: 30
[32m				save_model: [39m
					save_in: student
					save_after_epoch: 1
[32m			test: [39m
				epoch: 10
[32m	supervisor: [39m
[32m		dataloader: [39m
			name: dnn_sr_RL
			replay_window: 1000
			batch_size: 128
			epochs: 200
			format: tensor
[32m		model: [39m
			name: dnn
			units: [128, 64, 32, 1]
			activations: ['relu', 'relu', 'relu', 'softplus']
			dims: 64,32,16,1
[32m		optimizer: [39m
			name: sgd
			learning_rate: 0.01
[32m		loss: [39m
			name: MeanAbsoluteError
[32m		train_loop: [39m
[32m			valid: [39m
				valid_gap: 100
[32m				save_model: [39m
					save_in: supvervisor
					save_after_epochs: 1
[32m			preprocess: [39m
				name: normal
[32m			train: [39m
				epochs: 10
[32m			test: [39m
				epoch: 10
[32m		metrics: [39m
			name: MeanSquaredError
[32mStart to run![39m
[32mdevices: [][39m
[33mWARNING: no such path: ./log/cifar10-rl/tensorboard/student-0-20220627-091803, but we made.[39m
[33mWARNING: no such path: ./log/cifar10-rl/weight_space, but we made.[39m
Model: "dnn"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
flatten (Flatten)            multiple                  0         
_________________________________________________________________
linear (Linear)              multiple                  393344    
_________________________________________________________________
linear_1 (Linear)            multiple                  8256      
_________________________________________________________________
linear_2 (Linear)            multiple                  2080      
_________________________________________________________________
linear_3 (Linear)            multiple                  330       
_________________________________________________________________
activation (Activation)      multiple                  0         
_________________________________________________________________
activation_1 (Activation)    multiple                  0         
_________________________________________________________________
activation_2 (Activation)    multiple                  0         
_________________________________________________________________
activation_3 (Activation)    multiple                  0         
=================================================================
Total params: 404,010
Trainable params: 404,010
Non-trainable params: 0
_________________________________________________________________
Finished student 0 with best metric 0.5.
Finished training student 0
[32mdevices: [][39m
[33mWARNING: no such path: ./log/cifar10-rl/tensorboard/student-1-20220627-091809, but we made.[39m
Model: "dnn"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
flatten (Flatten)            multiple                  0         
_________________________________________________________________
linear (Linear)              multiple                  393344    
_________________________________________________________________
linear_1 (Linear)            multiple                  8256      
_________________________________________________________________
linear_2 (Linear)            multiple                  2080      
_________________________________________________________________
linear_3 (Linear)            multiple                  330       
_________________________________________________________________
activation (Activation)      multiple                  0         
_________________________________________________________________
activation_1 (Activation)    multiple                  0         
_________________________________________________________________
activation_2 (Activation)    multiple                  0         
_________________________________________________________________
activation_3 (Activation)    multiple                  0         
=================================================================
Total params: 404,010
Trainable params: 404,010
Non-trainable params: 0
_________________________________________________________________
Finished student 1 with best metric 0.5.
Finished training student 1
[32mdevices: [][39m
[33mWARNING: no such path: ./log/cifar10-rl/tensorboard/student-4-20220627-091827, but we made.[39m
Model: "dnn"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
flatten (Flatten)            multiple                  0         
_________________________________________________________________
linear (Linear)              multiple                  393344    
_________________________________________________________________
linear_1 (Linear)            multiple                  8256      
_________________________________________________________________
linear_2 (Linear)            multiple                  2080      
_________________________________________________________________
linear_3 (Linear)            multiple                  330       
_________________________________________________________________
activation (Activation)      multiple                  0         
_________________________________________________________________
activation_1 (Activation)    multiple                  0         
_________________________________________________________________
activation_2 (Activation)    multiple                  0         
_________________________________________________________________
activation_3 (Activation)    multiple                  0         
=================================================================
Total params: 404,010
Trainable params: 404,010
Non-trainable params: 0
_________________________________________________________________
Finished student 4 with best metric 0.5.
Finished training student 4
[32mdevices: [][39m
[33mWARNING: no such path: ./log/cifar10-rl/tensorboard/student-3-20220627-091828, but we made.[39m
Model: "dnn"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
flatten (Flatten)            multiple                  0         
_________________________________________________________________
linear (Linear)              multiple                  393344    
_________________________________________________________________
linear_1 (Linear)            multiple                  8256      
_________________________________________________________________
linear_2 (Linear)            multiple                  2080      
_________________________________________________________________
linear_3 (Linear)            multiple                  330       
_________________________________________________________________
activation (Activation)      multiple                  0         
_________________________________________________________________
activation_1 (Activation)    multiple                  0         
_________________________________________________________________
activation_2 (Activation)    multiple                  0         
_________________________________________________________________
activation_3 (Activation)    multiple                  0         
=================================================================
Total params: 404,010
Trainable params: 404,010
Non-trainable params: 0
_________________________________________________________________
Finished student 3 with best metric 0.5.
Finished training student 3
[32mdevices: [][39m
[33mWARNING: no such path: ./log/cifar10-rl/tensorboard/student-5-20220627-091906, but we made.[39m
Model: "dnn"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
flatten (Flatten)            multiple                  0         
_________________________________________________________________
linear (Linear)              multiple                  393344    
_________________________________________________________________
linear_1 (Linear)            multiple                  8256      
_________________________________________________________________
linear_2 (Linear)            multiple                  2080      
_________________________________________________________________
linear_3 (Linear)            multiple                  330       
_________________________________________________________________
activation (Activation)      multiple                  0         
_________________________________________________________________
activation_1 (Activation)    multiple                  0         
_________________________________________________________________
activation_2 (Activation)    multiple                  0         
_________________________________________________________________
activation_3 (Activation)    multiple                  0         
=================================================================
Total params: 404,010
Trainable params: 404,010
Non-trainable params: 0
_________________________________________________________________
Finished student 5 with best metric 0.5.
Finished training student 5
[32mdevices: [][39m
[33mWARNING: no such path: ./log/cifar10-rl/tensorboard/student-6-20220627-091911, but we made.[39m
Model: "dnn"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
flatten (Flatten)            multiple                  0         
_________________________________________________________________
linear (Linear)              multiple                  393344    
_________________________________________________________________
linear_1 (Linear)            multiple                  8256      
_________________________________________________________________
linear_2 (Linear)            multiple                  2080      
_________________________________________________________________
linear_3 (Linear)            multiple                  330       
_________________________________________________________________
activation (Activation)      multiple                  0         
_________________________________________________________________
activation_1 (Activation)    multiple                  0         
_________________________________________________________________
activation_2 (Activation)    multiple                  0         
_________________________________________________________________
activation_3 (Activation)    multiple                  0         
=================================================================
Total params: 404,010
Trainable params: 404,010
Non-trainable params: 0
_________________________________________________________________
Finished student 6 with best metric 0.5.
Finished training student 6
[32mdevices: [][39m
[33mWARNING: no such path: ./log/cifar10-rl/tensorboard/student-8-20220627-091930, but we made.[39m
Model: "dnn"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
flatten (Flatten)            multiple                  0         
_________________________________________________________________
linear (Linear)              multiple                  393344    
_________________________________________________________________
linear_1 (Linear)            multiple                  8256      
_________________________________________________________________
linear_2 (Linear)            multiple                  2080      
_________________________________________________________________
linear_3 (Linear)            multiple                  330       
_________________________________________________________________
activation (Activation)      multiple                  0         
_________________________________________________________________
activation_1 (Activation)    multiple                  0         
_________________________________________________________________
activation_2 (Activation)    multiple                  0         
_________________________________________________________________
activation_3 (Activation)    multiple                  0         
=================================================================
Total params: 404,010
Trainable params: 404,010
Non-trainable params: 0
_________________________________________________________________
Finished student 8 with best metric 0.5.
Finished training student 8
[32mdevices: [][39m
[33mWARNING: no such path: ./log/cifar10-rl/tensorboard/student-9-20220627-091932, but we made.[39m
Model: "dnn"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
flatten (Flatten)            multiple                  0         
_________________________________________________________________
linear (Linear)              multiple                  393344    
_________________________________________________________________
linear_1 (Linear)            multiple                  8256      
_________________________________________________________________
linear_2 (Linear)            multiple                  2080      
_________________________________________________________________
linear_3 (Linear)            multiple                  330       
_________________________________________________________________
activation (Activation)      multiple                  0         
_________________________________________________________________
activation_1 (Activation)    multiple                  0         
_________________________________________________________________
activation_2 (Activation)    multiple                  0         
_________________________________________________________________
activation_3 (Activation)    multiple                  0         
=================================================================
Total params: 404,010
Trainable params: 404,010
Non-trainable params: 0
_________________________________________________________________
Finished student 9 with best metric 0.5.
Finished training student 9
[32mdevices: [][39m
[33mWARNING: no such path: ./log/cifar10-rl/tensorboard/student-10-20220627-092007, but we made.[39m
Model: "dnn"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
flatten (Flatten)            multiple                  0         
_________________________________________________________________
linear (Linear)              multiple                  393344    
_________________________________________________________________
linear_1 (Linear)            multiple                  8256      
_________________________________________________________________
linear_2 (Linear)            multiple                  2080      
_________________________________________________________________
linear_3 (Linear)            multiple                  330       
_________________________________________________________________
activation (Activation)      multiple                  0         
_________________________________________________________________
activation_1 (Activation)    multiple                  0         
_________________________________________________________________
activation_2 (Activation)    multiple                  0         
_________________________________________________________________
activation_3 (Activation)    multiple                  0         
=================================================================
Total params: 404,010
Trainable params: 404,010
Non-trainable params: 0
_________________________________________________________________
Finished student 10 with best metric 0.5.
Finished training student 10
[32mdevices: [][39m
[33mWARNING: no such path: ./log/cifar10-rl/tensorboard/student-11-20220627-092013, but we made.[39m
Model: "dnn"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
flatten (Flatten)            multiple                  0         
_________________________________________________________________
linear (Linear)              multiple                  393344    
_________________________________________________________________
linear_1 (Linear)            multiple                  8256      
_________________________________________________________________
linear_2 (Linear)            multiple                  2080      
_________________________________________________________________
linear_3 (Linear)            multiple                  330       
_________________________________________________________________
activation (Activation)      multiple                  0         
_________________________________________________________________
activation_1 (Activation)    multiple                  0         
_________________________________________________________________
activation_2 (Activation)    multiple                  0         
_________________________________________________________________
activation_3 (Activation)    multiple                  0         
=================================================================
Total params: 404,010
Trainable params: 404,010
Non-trainable params: 0
_________________________________________________________________
Finished student 11 with best metric 0.5.
Finished training student 11
[32mdevices: [][39m
[33mWARNING: no such path: ./log/cifar10-rl/tensorboard/student-13-20220627-092027, but we made.[39m
Model: "dnn"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
flatten (Flatten)            multiple                  0         
_________________________________________________________________
linear (Linear)              multiple                  393344    
_________________________________________________________________
linear_1 (Linear)            multiple                  8256      
_________________________________________________________________
linear_2 (Linear)            multiple                  2080      
_________________________________________________________________
linear_3 (Linear)            multiple                  330       
_________________________________________________________________
activation (Activation)      multiple                  0         
_________________________________________________________________
activation_1 (Activation)    multiple                  0         
_________________________________________________________________
activation_2 (Activation)    multiple                  0         
_________________________________________________________________
activation_3 (Activation)    multiple                  0         
=================================================================
Total params: 404,010
Trainable params: 404,010
Non-trainable params: 0
_________________________________________________________________
Finished student 13 with best metric 0.5.
Finished training student 13
[32mdevices: [][39m
[33mWARNING: no such path: ./log/cifar10-rl/tensorboard/student-14-20220627-092029, but we made.[39m
Model: "dnn"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
flatten (Flatten)            multiple                  0         
_________________________________________________________________
linear (Linear)              multiple                  393344    
_________________________________________________________________
linear_1 (Linear)            multiple                  8256      
_________________________________________________________________
linear_2 (Linear)            multiple                  2080      
_________________________________________________________________
linear_3 (Linear)            multiple                  330       
_________________________________________________________________
activation (Activation)      multiple                  0         
_________________________________________________________________
activation_1 (Activation)    multiple                  0         
_________________________________________________________________
activation_2 (Activation)    multiple                  0         
_________________________________________________________________
activation_3 (Activation)    multiple                  0         
=================================================================
Total params: 404,010
Trainable params: 404,010
Non-trainable params: 0
_________________________________________________________________
Finished student 14 with best metric 0.5.
Finished training student 14
[32mdevices: [][39m
[33mWARNING: no such path: ./log/cifar10-rl/tensorboard/student-16-20220627-092110, but we made.[39m
Model: "dnn"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
flatten (Flatten)            multiple                  0         
_________________________________________________________________
linear (Linear)              multiple                  393344    
_________________________________________________________________
linear_1 (Linear)            multiple                  8256      
_________________________________________________________________
linear_2 (Linear)            multiple                  2080      
_________________________________________________________________
linear_3 (Linear)            multiple                  330       
_________________________________________________________________
activation (Activation)      multiple                  0         
_________________________________________________________________
activation_1 (Activation)    multiple                  0         
_________________________________________________________________
activation_2 (Activation)    multiple                  0         
_________________________________________________________________
activation_3 (Activation)    multiple                  0         
=================================================================
Total params: 404,010
Trainable params: 404,010
Non-trainable params: 0
_________________________________________________________________
Finished student 16 with best metric 0.5.
Finished training student 16
[32mdevices: [][39m
[33mWARNING: no such path: ./log/cifar10-rl/tensorboard/student-17-20220627-092119, but we made.[39m
Model: "dnn"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
flatten (Flatten)            multiple                  0         
_________________________________________________________________
linear (Linear)              multiple                  393344    
_________________________________________________________________
linear_1 (Linear)            multiple                  8256      
_________________________________________________________________
linear_2 (Linear)            multiple                  2080      
_________________________________________________________________
linear_3 (Linear)            multiple                  330       
_________________________________________________________________
activation (Activation)      multiple                  0         
_________________________________________________________________
activation_1 (Activation)    multiple                  0         
_________________________________________________________________
activation_2 (Activation)    multiple                  0         
_________________________________________________________________
activation_3 (Activation)    multiple                  0         
=================================================================
Total params: 404,010
Trainable params: 404,010
Non-trainable params: 0
_________________________________________________________________
Finished student 17 with best metric 0.5.
Finished training student 17
[32mdevices: [][39m
[33mWARNING: no such path: ./log/cifar10-rl/tensorboard/student-18-20220627-092123, but we made.[39m
Model: "dnn"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
flatten (Flatten)            multiple                  0         
_________________________________________________________________
linear (Linear)              multiple                  393344    
_________________________________________________________________
linear_1 (Linear)            multiple                  8256      
_________________________________________________________________
linear_2 (Linear)            multiple                  2080      
_________________________________________________________________
linear_3 (Linear)            multiple                  330       
_________________________________________________________________
activation (Activation)      multiple                  0         
_________________________________________________________________
activation_1 (Activation)    multiple                  0         
_________________________________________________________________
activation_2 (Activation)    multiple                  0         
_________________________________________________________________
activation_3 (Activation)    multiple                  0         
=================================================================
Total params: 404,010
Trainable params: 404,010
Non-trainable params: 0
_________________________________________________________________
Finished student 18 with best metric 0.5.
Finished training student 18
[32m[Task Status]: Task done! Time cost: {:}[39m
